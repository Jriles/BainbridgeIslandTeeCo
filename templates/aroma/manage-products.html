{% extends "/aroma/base.html" %}

{% block content %}
{% with messages = get_flashed_messages() %}
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-block alert-error section-error-alert">
              <a class="close" data-dismiss="alert">&times;</a>
              {{ message }}
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}
<div class="admin-container">
    <div>
        <a href="/admin"><button class="btn btn-success admin-button back-to-admin">Back To Admin Page</button></a>
    </div>
    <h2>Manage Your Products</h2>
    <div>
        <a href="/new-product"><button class="btn btn-info product_button admin-button">New Product</button></a>
    </div>
    <ul>
    {% for product in display_products %}
        {% set product_loop = loop %}
        <li>
            <h4>Product {{product_loop.index}}</h4>
            <form method="post" class="form admin-form" enctype="multipart/form-data">
                {{ edit_product_form.csrf_token }}
                Product Name:
                {{ edit_product_form.product_name(class_ = 'discount-form-element', value = product[1]) }}
                Product Price:
                {{ edit_product_form.product_price(class_ = 'discount-form-element', value = product[2]) }}
                Product Primary Image:
                {{ edit_product_form.primary_product_image(class_ = 'discount-form-element', value = product[5]) }}
                Product In Stock?
                {{ edit_product_form.product_in_stock(value = product[3], class_ = 'discount-form-element reset_me') }}
                Product Description:
                <textarea class="discount-form-element" name="description" id="description" type="text" >{{product[4]}}</textarea>
                {{ edit_product_form.product_id(class_ = 'discount-form-element', value = product[0]) }}
                <input type="submit" value="Submit Edits" class="btn btn-primary product_button admin-button">
            </form>
            <h5>Product Designs</h5>
            <div>
                <a href="/new-design/{{product[0]}}"><button class="btn btn-info product_button admin-button">New Design</button></a>
            </div>
            <div class="term-images-container card-group">
                {% for design in designs[product_loop.index-1] %}
                    <div class="card card-width-setting" id="{{design[0]}} Image"title="{{design[2]}} Image">
                        {% if design[3]!= None %}
                        <img class="card-img-top" alt="Picture Unavailable" src="{{ design[3] }}">
                        {% endif %}
                        <div class="card-body">
                            <form method="post" class="form admin-form" enctype="multipart/form-data">
                                {{ edit_design_form.csrf_token }}
                                Design Name:
                                {{ edit_design_form.edit_design_name(class_ = 'edit-design card-title', value = design[2]) }}
                                Change Image:
                                {{ edit_design_form.edit_design_image(value = design[3], class_ = 'edit-design card-text') }}
                                Change Icon:
                                <div class="icon-bucket">
                                    <img src="{{design[4]}}" class="icon-styling">
                                    {{ edit_design_form.edit_design_icon(value = design[4], class_ = 'card-text icon-input') }}
                                </div>
                                {{ edit_design_form.design_id(value = design[0], class_ = 'edit-design card-text') }}
                                <input type="submit" value="Edit Design" class="btn btn-primary product_button admin-button">
                                <div>
                                    <button class="btn btn-danger product_button admin-button design-delete-button"><a class="delete-link" href="/delete-design/{{design[0]}}">Delete Design</a></button>
                                </div>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </li>
    {% endfor %}
    </ul>
</div>
{% endblock %}